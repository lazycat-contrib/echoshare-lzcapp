import{u as N}from"./history.CmTeTBOX.js";import{u as O}from"./useDOM.iYFPuhyl.js";import{N as E,O as w,d as M,u as R,P as U,M as $,j as C,c as b,f as i,m as r,r as h,e as g,n as f,t as c,h as V,o as D,_ as L}from"./index.DoEgvpef.js";const j=()=>{var y;const l=(y=E())==null?void 0:y.appContext;if(!l)throw new Error("useModal can be used only in setup function. You can use app.config.globalProperties.$vaModal outside setup function");return{init:t=>w(t,l),confirm:t=>typeof t=="string"?new Promise((s,u)=>{w({message:t,onOk(){s(!0)},onCancel(){s(!1)}},l)}):new Promise((s,u)=>{w({...t,onOk(){var o;(o=t==null?void 0:t.onOk)==null||o.call(t),s(!0)},onCancel(){var o;(o=t==null?void 0:t.onCancel)==null||o.call(t),s(!1)}},l)})}},z={class:"mt-4"},H={class:"flex-1 text-left"},W={class:"max-sm:hidden"},G={class:"max-sm:hidden"},q={class:"sm:hidden"},F={key:0,class:"text-center py-4 text-gray-500"},Y={key:1},J={class:"flex mt-4 w-full"},K=M({__name:"history",setup(y){const{t:l}=R(),{confirm:k}=j(),{mergeGlobalConfig:P}=U();P({components:{presets:{VaPagination:{customPagination:{color:"#177884",activePageColor:"#117783"}}}}});const{width:t}=O(),s=N(),u=$(()=>s.history.sort((a,n)=>n.timestamp-a.timestamp)),o=C(10),_=C(1),A=$(()=>o.value&&o.value!==0?Math.ceil(u.value.length/o.value):u.value.length),d=C([]),T=()=>[{key:"time",label:l("history.labelTime"),thAlign:"center",tdAlign:"center",sortable:!0,width:"190px",tdClass:"echoshare-history-time"},{key:"UID",thAlign:"center",tdAlign:"center",sortable:!0,tdClass:"echoshare-history-uid"},{key:"ACTION",label:l("history.labelAction"),thAlign:"center",tdAlign:"center",sortable:!0,width:"120px"},{key:"RESULT",label:l("history.labelResult"),thAlign:"center",tdAlign:"center",sortable:!0,width:"120px"}];function x(a=!1){if(a){s.history=[],d.value=[];return}const n=d.value.length;k(l("history.deleteRecordsTip",{count:n})).then(m=>{if(!m)return;const v=d.value.map(p=>p.timestamp);s.history=s.history.filter(p=>!v.includes(p.timestamp)),d.value=[]})}return(a,n)=>{const m=h("VaButton"),v=h("VaCardTitle"),p=h("VaDataTable"),I=h("VaPagination"),S=h("VaCardContent"),B=h("VaCard");return D(),b("div",z,[i(B,{class:"m-auto flex flex-col w-5/6 mb-4"},{default:r(()=>[i(v,{class:"text-lg flex items-center w-full"},{default:r(()=>[g("div",H,[f(c(a.$t("history.titleAlwaysShow"))+" ",1),g("span",W,c(a.$t("history.titleCanHide")),1)]),i(m,{color:"danger",icon:"delete_sweep",class:"flex-none",onClick:n[0]||(n[0]=e=>x(V(t)<640)),disabled:d.value.length===0&&V(t)>640||u.value.length==0},{default:r(()=>[g("span",G,c(a.$t("history.deleteWhatPC")),1),g("span",q,c(a.$t("history.deleteWhatPhone")),1)]),_:1},8,["disabled"])]),_:1}),i(S,null,{default:r(()=>[u.value.length===0?(D(),b("div",F,c(a.$t("history.noRecordsTip")),1)):(D(),b("div",Y,[i(p,{selectable:V(t)>640,items:u.value,"per-page":o.value,"current-page":_.value,columns:T(),onSelectionChange:n[1]||(n[1]=e=>d.value=e.currentSelectedItems)},{"cell(UID)":r(e=>[i(m,{preset:"secondary","border-color":"primary",class:"mr-6 mb-2",size:"small",onClick:Q=>e.rowData.uid&&a.$router.push({query:{uid:e.rowData.uid},path:"/~"+e.rowData.action})},{default:r(()=>[f(c(e.rowData.uid||a.$t("history.NO_UID_LABLE")),1)]),_:2},1032,["onClick"])]),"cell(ACTION)":r(e=>[i(m,{size:"small",color:e.rowData.action==="share"?"info":"#663BBD",gradient:"","icon-right":e.rowData.action==="share"?"arrow_forward":"",icon:e.rowData.action==="share"?"":"arrow_back"},{default:r(()=>[f(c(e.rowData.action==="share"?a.$t("history.actionShare"):a.$t("history.actionReceive")),1)]),_:2},1032,["color","icon-right","icon"])]),"cell(RESULT)":r(e=>[i(m,{size:"small",color:e.rowData.result==="success"?"success":"danger",gradient:"",icon:e.rowData.result==="success"?"check":"clear"},{default:r(()=>[f(c(e.rowData.result==="success"?a.$t("history.resultSuccess"):a.$t("history.resultFail")),1)]),_:2},1032,["color","icon"])]),_:1},8,["selectable","items","per-page","current-page","columns"]),g("div",J,[i(I,{class:"justify-center",modelValue:_.value,"onUpdate:modelValue":n[2]||(n[2]=e=>_.value=e),pages:A.value,"visible-pages":3,preset:"customPagination",gapped:"",rounded:""},null,8,["modelValue","pages"])])]))]),_:1})]),_:1})])}}}),te=L(K,[["__scopeId","data-v-45f5a63a"]]);export{te as default};
